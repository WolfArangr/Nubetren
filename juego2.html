<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0">
<title>Catmon Retro</title>
<style>
  * {
    margin: 0;
    padding: 0;
    user-select: none;
    -webkit-user-select: none;
    touch-action: manipulation;
    font-family: monospace;
  }
  html, body {
    background: black;
    color: white;
    height: 100%;
    overflow: hidden;
  }
  #game {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100vh;
    padding: 1rem;
    box-sizing: border-box;
  }
  .screen {
    flex: 1;
    border: 2px solid white;
    margin-bottom: 1rem;
    padding: 1rem;
    overflow-y: auto;
    background-color: #111;
    font-size: 1.1rem;
    white-space: pre-wrap;
  }
  .hud {
    display: flex;
    justify-content: space-between;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
  }
  .bar {
    background: red;
    height: 10px;
    flex: 1;
    margin: 0 5px;
  }
  .bar.green {
    background: limegreen;
  }
  button {
    width: 48%;
    padding: 1rem;
    background: #222;
    color: white;
    font-size: 1rem;
    border: 1px solid white;
  }
  #btns {
    display: flex;
    flex-wrap: wrap;
    gap: 4%;
    justify-content: space-between;
  }
</style>
</head>
<body>
<audio id="music" src="https://upload.wikimedia.org/wikipedia/commons/4/4e/8bit_battle_theme.ogg" loop autoplay></audio>
<div id="game">
  <div class="screen" id="log">üê± Bienvenido a Catmon Retro!</div>
  <div class="hud">
    <div>üê± HP:</div>
    <div class="bar green" id="playerHP"></div>
    <div id="enemyName">üíÄ</div>
    <div class="bar" id="enemyHP"></div>
  </div>
  <div id="btns">
    <button onclick="attack()">Atacar</button>
    <button onclick="heal()">Curar</button>
    <button onclick="train()">Entrenar</button>
    <button onclick="save()">Guardar</button>
  </div>
</div>

<script>
const log = document.getElementById('log');
const playerBar = document.getElementById('playerHP');
const enemyBar = document.getElementById('enemyHP');
const enemyName = document.getElementById('enemyName');

const enemies = [
  { name: 'ü¶Ö √Åguila', type: 'picotazo' },
  { name: 'üêç Serpiente', type: 'veneno' },
  { name: 'üê∏ Rana', type: 'salto' },
  { name: 'üêª Oso', type: 'zarpa' },
  { name: 'ü¶ä Zorro', type: 'mordisco' },
  { name: 'üê¶ P√°jaro', type: 'picotazo' },
  { name: 'üê± Gato oscuro', type: 'garra' },
  { name: 'üêî Gallo furioso', type: 'espol√≥n' },
  { name: 'ü¶â B√∫ho', type: 'vista penetrante' },
  { name: 'üêó Jabal√≠', type: 'cornada' }
];

let state = {
  playerHP: 100,
  enemyHP: 100,
  power: 10,
  level: 1,
  xp: 0,
  enemy: {}
};

function pickEnemy() {
  const e = enemies[Math.floor(Math.random() * enemies.length)];
  state.enemy = { ...e };
  state.enemyHP = 100;
  enemyName.textContent = e.name;
}

function load() {
  const saved = localStorage.getItem('catmon');
  if (saved) state = JSON.parse(saved);
  if (!state.enemy || !state.enemy.name) pickEnemy();
  updateBars();
  logMessage(`üê± Nivel ${state.level} vs ${state.enemy.name}`);
}
function save() {
  localStorage.setItem('catmon', JSON.stringify(state));
  logMessage("üíæ Partida guardada.");
}
function updateBars() {
  playerBar.style.width = Math.max(state.playerHP, 0) + '%';
  playerBar.classList.toggle('green', state.playerHP > 20);
  enemyBar.style.width = Math.max(state.enemyHP, 0) + '%';
  enemyName.textContent = state.enemy.name;
}
function logMessage(msg) {
  log.textContent = msg;
}
function attack() {
  let dmg = Math.floor(Math.random() * state.power) + 5;
  state.enemyHP -= dmg;
  logMessage(`üê± atac√≥: -${dmg} HP al ${state.enemy.name}\n`);
  if (state.enemyHP <= 0) {
    logMessage(`üéâ ¬°Derrotaste a ${state.enemy.name}!\n+10 XP`);
    state.xp += 10;
    pickEnemy();
    if (state.xp >= 30) {
      state.level++;
      state.power += 5;
      state.xp = 0;
      logMessage(`‚¨ÜÔ∏è Subiste a nivel ${state.level}!`);
    }
  } else {
    enemyAttack();
  }
  updateBars();
}
function enemyAttack() {
  let type = state.enemy.type;
  let dmg = 0;
  let txt = "";

  switch(type) {
    case 'picotazo':
      dmg = Math.floor(Math.random() * 10) + 5;
      txt = "picote√≥ con furia";
      break;
    case 'veneno':
      dmg = Math.floor(Math.random() * 8) + 7;
      txt = "inyect√≥ veneno";
      break;
    case 'zarpa':
      dmg = Math.floor(Math.random() * 15) + 5;
      txt = "zarp√≥ brutalmente";
      break;
    case 'mordisco':
      dmg = Math.floor(Math.random() * 12) + 6;
      txt = "mordi√≥ con rapidez";
      break;
    case 'salto':
      dmg = Math.floor(Math.random() * 10) + 3;
      txt = "salt√≥ y te golpe√≥";
      break;
    case 'garra':
      dmg = Math.floor(Math.random() * 10) + 5;
      txt = "ara√±√≥ ferozmente";
      break;
    case 'espol√≥n':
      dmg = Math.floor(Math.random() * 12) + 4;
      txt = "te espolone√≥";
      break;
    case 'vista penetrante':
      dmg = Math.floor(Math.random() * 6) + 3;
      txt = "te hipnotiz√≥ con su mirada";
      break;
    case 'cornada':
      dmg = Math.floor(Math.random() * 15) + 10;
      txt = "embisti√≥ como un rayo";
      break;
    default:
      dmg = 10;
      txt = "te atac√≥";
  }

  state.playerHP -= dmg;
  logMessage(log.textContent + `\n${state.enemy.name} ${txt}: -${dmg} HP`);
  if (state.playerHP <= 0) {
    logMessage("üíÄ ¬°Has sido derrotado! Reinicio...");
    state.playerHP = 100;
    state.xp = 0;
    pickEnemy();
  }
}
function heal() {
  if (state.playerHP < 100) {
    state.playerHP += 20;
    if (state.playerHP > 100) state.playerHP = 100;
    logMessage("üçó Curado 20 HP.");
    enemyAttack();
    updateBars();
  } else {
    logMessage("üßò Ya est√°s al m√°ximo.");
  }
}
function train() {
  state.power += 2;
  logMessage("üèãÔ∏è Entrenaste. Poder +2.");
}
load();
</script>
</body>
</html>
