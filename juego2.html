<!DOCTYPE html>
<html lang="es">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta charset="UTF-8">
  <title>Climb the Cloud</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
      touch-action: manipulation;
      background: linear-gradient(to top, #000428, #004e92);
      height: 100%;
      width: 100%;
    }
    canvas {
      display: block;
      width: 100vw;
      height: 100vh;
      background: transparent;
    }
    #controls {
      position: fixed;
      bottom: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background: rgba(0,0,0,0.3);
      user-select: none;
    }
    #left-controls {
      display: flex;
      gap: 10px;
    }
    button {
      font-size: 28px;
      padding: 10px 20px;
      border: none;
      border-radius: 10px;
      background: #fff;
      opacity: 0.9;
      user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
    }
  </style>
</head>
<body>
  <canvas id="game"></canvas>
  <div id="controls">
    <div id="left-controls">
      <button onclick="moveLeft()">‚¨ÖÔ∏è</button>
      <button onclick="moveRight()">‚û°Ô∏è</button>
    </div>
    <button onclick="jump()">‚¨ÜÔ∏è</button>
  </div>
  <audio id="bgm" loop autoplay>
    <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_a5804b9279.mp3?filename=arcade-game-loop-144135.mp3" type="audio/mpeg">
  </audio>
  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    let W = window.innerWidth;
    let H = window.innerHeight;
    canvas.width = W;
    canvas.height = H;

    let platforms = [];
    let camY = 0;

    const groundHeight = 40;

    const cat = {
      x: W / 2,
      y: H - groundHeight - 40,
      vx: 0,
      vy: 0,
      dir: 'right',
      width: 40,
      height: 40,
      grounded: false
    };

    function randPlatform(y) {
      return {
        x: Math.random() * (W - 80),
        y: y,
        width: 80,
        height: 10
      };
    }

    function generatePlatforms() {
      platforms = [];
      for (let y = H - groundHeight - 60; y > -3000; y -= 120) {
        platforms.push(randPlatform(y));
      }
    }

    generatePlatforms();

    function drawCat() {
      ctx.font = "40px Arial";
      ctx.textAlign = "center";
      const emoji = cat.dir === 'right' ? "üêà" : "üêà‚Äç‚¨ÖÔ∏è";
      ctx.fillText(emoji, cat.x + cat.width / 2, cat.y + cat.height);
    }

    function drawPlatforms() {
      ctx.fillStyle = "#fff";
      platforms.forEach(p => {
        ctx.fillRect(p.x, p.y - camY, p.width, p.height);
      });
    }

    function drawGround() {
      ctx.fillStyle = "#222";
      ctx.fillRect(0, H - groundHeight, W, groundHeight);
    }

    function drawCloudGoal() {
      ctx.font = "50px Arial";
      ctx.fillText('‚òÅÔ∏è', W / 2, platforms[platforms.length - 1].y - camY - 100);
    }

    function physics() {
      cat.vy += 0.5; // gravedad
      cat.x += cat.vx;
      cat.y += cat.vy;

      // Limites horizontales
      if (cat.x < 0) cat.x = 0;
      if (cat.x > W - cat.width) cat.x = W - cat.width;

      cat.grounded = false;

      // Plataforma suelo s√≥lida
      if (cat.y + cat.height > H - groundHeight) {
        cat.y = H - groundHeight - cat.height;
        cat.vy = 0;
        cat.grounded = true;
      } else {
        // Revisar colisiones con plataformas
        platforms.forEach(p => {
          if (
            cat.x + cat.width > p.x &&
            cat.x < p.x + p.width &&
            cat.y + cat.height > p.y &&
            cat.y + cat.height < p.y + p.height + 10 &&
            cat.vy >= 0
          ) {
            cat.y = p.y - cat.height;
            cat.vy = 0;
            cat.grounded = true;
          }
        });
      }

      // C√°mara sigue al gato solo si sube
      if (cat.y < camY + H / 2) camY = cat.y - H / 2;

      // Ca√≠da mortal (muy abajo)
      if (cat.y - camY > H + 200) reset();

      // Condici√≥n de victoria
      if (cat.y < platforms[platforms.length - 1].y - 100) {
        alert("¬°Nivel completado!");
        reset();
      }
    }

    function reset() {
      cat.x = W / 2;
      cat.y = H - groundHeight - cat.height;
      cat.vx = 0;
      cat.vy = 0;
      camY = 0;
      generatePlatforms();
    }

    function render() {
      ctx.clearRect(0, 0, W, H);
      drawGround();
      drawPlatforms();
      drawCloudGoal();
      drawCat();
    }

    function gameLoop() {
      physics();
      render();
      requestAnimationFrame(gameLoop);
    }

    gameLoop();

    function moveLeft() {
      cat.vx = -4;
      cat.dir = 'left';
    }

    function moveRight() {
      cat.vx = 4;
      cat.dir = 'right';
    }

    function jump() {
      if (cat.grounded) cat.vy = -12;
    }

    window.addEventListener("touchend", () => {
      cat.vx = 0;
    });

    window.addEventListener("resize", () => {
      W = window.innerWidth;
      H = window.innerHeight;
      canvas.width = W;
      canvas.height = H;
    });
  </script>
</body>
</html>
